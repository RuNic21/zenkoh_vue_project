---
description: Vue 3 Composition API ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—åˆ¥é©ç”¨ï¼‰
alwaysApply: false
---
# Vue 3 Composition API ãƒ‘ã‚¿ãƒ¼ãƒ³

## ğŸ¯ åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹é€ 
```vue
<script setup lang="ts">
// ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç›®çš„ã‚’ç°¡æ½”ã«èª¬æ˜
import { ref, computed, onMounted } from "vue";

// Propså®šç¾©ï¼ˆç”¨é€”ã‚’æ—¥æœ¬èªã‚³ãƒ¡ãƒ³ãƒˆã§èª¬æ˜ï¼‰
const props = defineProps<{
  // å—ã‘å–ã‚‹ãƒ‡ãƒ¼ã‚¿ã®ç”¨é€”ã‚’èª¬æ˜
  propName: string;
  optionalProp?: number;
}>();

// Emitså®šç¾©
const emit = defineEmits<{
  // ã‚¤ãƒ™ãƒ³ãƒˆåã¨å¼•æ•°ã®å‹ã‚’å®šç¾©
  update: [value: string];
  delete: [id: number];
}>();

// ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿
const state = ref("");
const derived = computed(() => state.value);

// ãƒ¡ã‚½ãƒƒãƒ‰
const handleEvent = () => {
  // ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã®æ„å›³ã‚’èª¬æ˜
  emit("update", state.value);
};

// ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
onMounted(() => {
  console.log("ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒã‚¦ãƒ³ãƒˆå®Œäº†");
});
</script>

<template>
  <!-- ãƒ«ãƒ¼ãƒˆè¦ç´ ã®å½¹å‰²ã‚’èª¬æ˜ -->
  <div class="component-name">
    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³èª¬æ˜ -->
    <header></header>
    <main></main>
  </div>
</template>

<style scoped>
/* å¿…è¦ãªç¯„å›²ã®ã¿ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨ */
</style>
```

### 2. Storeä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// Store ã®ä½¿ç”¨ä¾‹
import { useScheduleStore } from "@/store/schedule";

const store = useScheduleStore();

// ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
await store.loadAll();

// ãƒ‡ãƒ¼ã‚¿æ“ä½œ
await store.save(updatedItem);
await store.create(newItem);
await store.delete(itemId);

// ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿å‚ç…§
const schedules = computed(() => store.schedules.value);
const selectedSchedule = computed(() => store.selectedSchedule.value);
```

### 3. ã‚µãƒ¼ãƒ“ã‚¹å±¤ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// åŸºæœ¬ã‚µãƒ¼ãƒ“ã‚¹ä½¿ç”¨ä¾‹
import { listTasks, createTask } from "@/services/taskService";
import { taskToScheduleItem } from "@/utils/taskAdapter";

// ãƒ‡ãƒ¼ã‚¿å–å¾—
const tasks = await listTasks();
const scheduleItems = tasksToScheduleItems(tasks);

// ãƒ‡ãƒ¼ã‚¿ä½œæˆ
const newTask = await createTask({
  project_id: 1,
  task_name: "æ–°ã—ã„ã‚¿ã‚¹ã‚¯",
  status: "NOT_STARTED"
});

// å°‚é–€ã‚µãƒ¼ãƒ“ã‚¹ä½¿ç”¨ä¾‹
import { fetchProjectProgress } from "@/services/dashboardService";
import { listUsers, createUser } from "@/services/teamService";
import { generateReport } from "@/services/reportService";
import { listNotifications } from "@/services/notificationService";

// ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµ±è¨ˆ
const stats = await fetchProjectProgress();

// ãƒãƒ¼ãƒ ç®¡ç†
const users = await listUsers();
const newUser = await createUser(userData);

// ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
const report = await generateReport(options);

// é€šçŸ¥ç®¡ç†
const notifications = await listNotifications();
```

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. ä¸€è¦§ â†’ è©³ç´°é·ç§»
```typescript
// ä¸€è¦§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
const handleItemClick = (item: ScheduleItem) => {
  store.selectSchedule(item.id);
  // App.vue ã® watch ã§è‡ªå‹•çš„ã«è©³ç´°ãƒšãƒ¼ã‚¸ã¸é·ç§»
};

// App.vue
watch(() => store.selectedScheduleId.value, (id) => {
  if (id != null) {
    currentPage.value = "schedule-detail";
  }
});
```

### 2. ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// åŸºæœ¬ãƒ•ã‚©ãƒ¼ãƒ 
const formData = ref({
  title: "",
  description: "",
  startDate: "",
  endDate: ""
});

const isSubmitting = ref(false);

const handleSubmit = async () => {
  if (isSubmitting.value) return;
  
  isSubmitting.value = true;
  try {
    await store.create(formData.value);
    // æˆåŠŸå‡¦ç†
    formData.value = { title: "", description: "", startDate: "", endDate: "" };
  } catch (error) {
    console.error("ä½œæˆã«å¤±æ•—:", error);
    alert("ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ");
  } finally {
    isSubmitting.value = false;
  }
};

// è¤‡é›‘ãªãƒ•ã‚©ãƒ¼ãƒ ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ä»˜ãï¼‰
const userForm = ref({
  name: "",
  email: "",
  role: "user",
  isActive: true
});

const errors = ref<Record<string, string>>({});

const validateForm = (): boolean => {
  errors.value = {};
  
  if (!userForm.value.name) {
    errors.value.name = "åå‰ã¯å¿…é ˆã§ã™";
  }
  
  if (!userForm.value.email) {
    errors.value.email = "ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å¿…é ˆã§ã™";
  } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(userForm.value.email)) {
    errors.value.email = "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„";
  }
  
  return Object.keys(errors.value).length === 0;
};

const handleUserSubmit = async () => {
  if (!validateForm()) return;
  
  try {
    await createUser(userForm.value);
    // æˆåŠŸå‡¦ç†
  } catch (error) {
    console.error("ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã«å¤±æ•—:", error);
  }
};
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
const handleAsyncOperation = async () => {
  try {
    const result = await someAsyncFunction();
    if (!result) {
      throw new Error("æ“ä½œãŒå¤±æ•—ã—ã¾ã—ãŸ");
    }
    // æˆåŠŸå‡¦ç†
  } catch (error) {
    console.error("ã‚¨ãƒ©ãƒ¼è©³ç´°:", error);
    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    alert("æ“ä½œã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãæ™‚é–“ã‚’ãŠã„ã¦å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚");
  }
};
```

## ğŸ¨ Material Dashboard UI ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹é€ 
```vue
<template>
  <div class="g-sidenav-show bg-gray-100">
    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-radius-lg fixed-start ms-2 bg-white my-2">
      <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    </aside>
    
    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg">
      <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
      <nav class="navbar navbar-main navbar-expand-lg px-0 mx-3 shadow-none border-radius-xl">
        <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
      </nav>
      
      <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
      <div class="container-fluid py-4">
        <!-- ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
      </div>
    </main>
  </div>
</template>
```

### 2. ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
```vue
<template>
  <div class="card">
    <div class="card-header pb-0">
      <div class="row">
        <div class="col-lg-6 col-8">
          <h6>ã‚«ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«</h6>
          <p class="text-sm mb-0">
            <i class="fa fa-chart-line text-info" aria-hidden="true"></i>
            <span class="font-weight-bold ms-1">ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«</span>
          </p>
        </div>
      </div>
    </div>
    <div class="card-body px-0 pt-0 pb-2">
      <!-- ã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    </div>
  </div>
</template>
```

### 3. çµ±è¨ˆã‚«ãƒ¼ãƒ‰
```vue
<template>
  <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
    <div class="card">
      <div class="card-header p-2 ps-3">
        <div class="d-flex justify-content-between">
          <div>
            <p class="text-sm mb-0 text-capitalize">ãƒ©ãƒ™ãƒ«</p>
            <h4 class="mb-0">{{ value }}</h4>
          </div>
          <div class="icon icon-md icon-shape bg-gradient-primary shadow-dark shadow text-center border-radius-lg">
            <i class="material-symbols-rounded opacity-10">icon_name</i>
          </div>
        </div>
      </div>
      <hr class="dark horizontal my-0">
      <div class="card-footer p-2 ps-3">
        <p class="mb-0 text-sm">
          <span class="text-success font-weight-bolder">+{{ change }}</span> å¤‰æ›´å†…å®¹
        </p>
      </div>
    </div>
  </div>
</template>
```

### 4. ãƒœã‚¿ãƒ³ã¨ãƒãƒƒã‚¸
```vue
<template>
  <!-- ãƒœã‚¿ãƒ³ -->
  <button class="btn btn-sm bg-gradient-primary mb-0">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</button>
  <button class="btn btn-sm bg-gradient-secondary mb-0">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
  <button class="btn btn-sm bg-gradient-success mb-0">ä¿å­˜</button>
  <button class="btn btn-sm bg-gradient-warning mb-0">æ³¨æ„</button>
  <button class="btn btn-sm bg-gradient-danger mb-0">å‰Šé™¤</button>

  <!-- ãƒãƒƒã‚¸ -->
  <span class="badge bg-gradient-success">å®Œäº†</span>
  <span class="badge bg-gradient-warning">é€²è¡Œä¸­</span>
  <span class="badge bg-gradient-danger">é…å»¶</span>
  <span class="badge bg-gradient-info">äºˆå®š</span>
</template>
```

### 5. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã‚°ãƒªãƒƒãƒ‰
```vue
<template>
  <!-- 4ã‚«ãƒ©ãƒ çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
  <div class="row mb-4">
    <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
      <!-- ã‚«ãƒ¼ãƒ‰å†…å®¹ -->
    </div>
  </div>

  <!-- 2ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ -->
  <div class="row">
    <div class="col-lg-8 col-md-6">
      <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    </div>
    <div class="col-lg-4 col-md-6">
      <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
    </div>
  </div>
</template>
```

## ğŸ”§ ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. UI ãƒ˜ãƒ«ãƒ‘ãƒ¼ä½¿ç”¨
```typescript
import { getStatusBadgeClass, getProgressBarClass } from "@/utils/uiHelpers";

// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå†…ã§ä½¿ç”¨
<span :class="getStatusBadgeClass(item.status)">{{ item.status }}</span>
<div :class="getProgressBarClass(item.progress)" :style="{ width: item.progress + '%' }"></div>
```

### 2. ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ä½¿ç”¨
```typescript
import { taskToScheduleItem, scheduleItemToTaskUpdate } from "@/utils/taskAdapter";

// DB â†’ UI å¤‰æ›
const scheduleItems = tasks.map(task => taskToScheduleItem(task, users));

// UI â†’ DB å¤‰æ›
const taskUpdate = scheduleItemToTaskUpdate(scheduleItem);
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ä½¿ç”¨
```typescript
import { handleError, showErrorMessage } from "@/utils/errorHandler";

const handleAsyncOperation = async () => {
  try {
    const result = await someAsyncFunction();
    return result;
  } catch (error) {
    handleError(error, "æ“ä½œã«å¤±æ•—ã—ã¾ã—ãŸ");
    return null;
  }
};
```

### 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ä½¿ç”¨
```typescript
import { debounce, throttle } from "@/utils/performanceUtils";

// æ¤œç´¢å…¥åŠ›ã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹
const searchQuery = ref("");
const debouncedSearch = debounce(async (query: string) => {
  if (query.length > 2) {
    const results = await searchItems(query);
    searchResults.value = results;
  }
}, 300);

watch(searchQuery, (newQuery) => {
  debouncedSearch(newQuery);
});

// ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚¹ãƒ­ãƒƒãƒˆãƒ«
const handleScroll = throttle(() => {
  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å‡¦ç†
}, 100);
```

## ğŸ“± çŠ¶æ…‹ç®¡ç†ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹
```typescript
// ãƒ•ã‚©ãƒ¼ãƒ çŠ¶æ…‹
const formData = ref({
  title: "",
  description: ""
});

// ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹
const isLoading = ref(false);

// ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹
const errorMessage = ref("");
```

### 2. ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ï¼ˆStoreï¼‰
```typescript
// Store ã‹ã‚‰çŠ¶æ…‹å–å¾—
const schedules = computed(() => store.schedules.value);
const selectedSchedule = computed(() => store.selectedSchedule.value);

// Store æ“ä½œ
const selectSchedule = (id: number) => {
  store.selectSchedule(id);
};
```

## ğŸ¯ TypeScript ãƒ‘ã‚¿ãƒ¼ãƒ³

### 1. åŸºæœ¬å‹å®šç¾©
```typescript
// ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ç”¨å‹
export interface ScheduleItem {
  id: number;
  title: string;
  description: string;
  startDate: string;
  endDate: string;
  status: ScheduleStatus;
  priority: SchedulePriority;
  assignee: string;
  progress: number;
  category: string;
  tags: string[];
  notes: string;
  attachments: string[];
  comments: Comment[];
}

// åˆ—æŒ™å‹
export type ScheduleStatus = "äºˆå®š" | "é€²è¡Œä¸­" | "å®Œäº†" | "é…å»¶" | "ä¿ç•™";
export type SchedulePriority = "é«˜" | "ä¸­" | "ä½";

// ã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«å‹
export interface TaskInsert {
  project_id: number;
  task_name: string;
  description?: string;
  status?: string;
  priority?: string;
  progress_percent?: number;
}
```

### 2. é–¢æ•°å‹å®šç¾©
```typescript
// åŸºæœ¬é–¢æ•°
export function createTask(payload: TaskInsert): Promise<Task | null>;

// éåŒæœŸé–¢æ•°
export async function updateTask(
  id: number, 
  payload: TaskUpdate
): Promise<Task | null>;

// ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å‹
export type Result<T, E = Error> = 
  | { success: true; data: T }
  | { success: false; error: E };
```

### 3. å‹ã‚¬ãƒ¼ãƒ‰
```typescript
// åŸºæœ¬å‹ã‚¬ãƒ¼ãƒ‰
function isString(value: unknown): value is string {
  return typeof value === "string";
}

function isTask(value: unknown): value is Task {
  return (
    typeof value === "object" &&
    value !== null &&
    "id" in value &&
    "task_name" in value &&
    "status" in value
  );
}
```

## ğŸš¨ æ³¨æ„äº‹é …

### 1. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- `v-for` ã«ã¯å¿…ãš `:key` ã‚’è¨­å®š
- å¤§ããªãƒªã‚¹ãƒˆã«ã¯ä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æ¤œè¨
- ä¸è¦ãªãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ‡ãƒ¼ã‚¿ã¯é¿ã‘ã‚‹

### 2. ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£
- ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ãª HTML è¦ç´ ã‚’ä½¿ç”¨
- `aria-label` ã‚„ `aria-describedby` ã‚’é©åˆ‡ã«è¨­å®š
- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆ

### 3. å‹å®‰å…¨æ€§
- TypeScript ã®å‹ã‚’æ´»ç”¨
- `any` å‹ã®ä½¿ç”¨ã‚’é¿ã‘ã‚‹
- ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å‹å®šç¾©ã‚’æ˜ç¢ºã«ã™ã‚‹